<div class="container mx-auto px-4 py-8">
  <h2 class="text-2xl font-bold mb-4">Gestión de Roles</h2>

  <form [formGroup]="roleForm" (ngSubmit)="onSubmit()" class="mb-8">
    <div class="mb-4">
      <label for="nombre" class="block text-sm font-medium text-gray-700">Nombre del Rol</label>
      <input type="text" id="nombre" formControlName="nombre" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
    </div>

    <div class="mb-4">
      <label for="descripcion" class="block text-sm font-medium text-gray-700">Descripción</label>
      <textarea id="descripcion" formControlName="descripcion" rows="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"></textarea>
    </div>

    <div class="mb-4">
      <label class="block text-sm font-medium text-gray-700">Permisos</label>
      <div class="mt-2 space-y-2" formArrayName="permisos">
        <div *ngFor="let permiso of permisos; let i = index" class="flex items-center">
          <input type="checkbox" [formControlName]="i" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
          <label class="ml-2 block text-sm text-gray-900">
            {{ permiso.nombre }}
          </label>
        </div>
      </div>
    </div>

    <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
      {{ editingRole ? 'Actualizar' : 'Crear' }} Rol
    </button>
    <button type="button" (click)="resetForm()" class="ml-2 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded">
      Cancelar
    </button>
  </form>

  <table class="min-w-full divide-y divide-gray-200">
    <thead class="bg-gray-50">
      <tr>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nombre</th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Descripción</th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Permisos</th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Acciones</th>
      </tr>
    </thead>
    <tbody class="bg-white divide-y divide-gray-200">
      <tr *ngFor="let role of roles">
        <td class="px-6 py-4 whitespace-nowrap">{{ role.nombre }}</td>
        <td class="px-6 py-4 whitespace-nowrap">{{ role.descripcion }}</td>
        <td class="px-6 py-4 whitespace-nowrap">
          <span *ngFor="let permiso of role.permisos" class="inline-block bg-gray-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2">
            {{ permiso.nombre }}
          </span>
        </td>
        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
          <button (click)="editRole(role)" class="text-indigo-600 hover:text-indigo-900 mr-2">Editar</button>
          <button (click)="deleteRole(role.id!)" class="text-red-600 hover:text-red-900">Eliminar</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
